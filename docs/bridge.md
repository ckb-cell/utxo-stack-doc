# 带质押安全的 BTC 跨链桥

Bridge Operator (下称 BO) 质押一部分资金在 CKB 上，他们提供 BTC == L2 的跨链桥。L2 的 BTC 记为 $BTC2L，存在以下设置：

- L2 上存在一个 BTC SPV 轻节点，或者至少 L2 上的合约可以直接访问一个 BTC SPV 轻节点（在 L2 上或 CKB 上）
- 存在一个由 BO 管理的 BTC 多签地址用来进行 btc 的跨链出入金

## 入金

用户将 bitcoin 在 Bitcoin 链上转入上述多签地址，并在 OP_RETURN 等位置设定收款地址。L2 SPV 同步到该信息后，L2 合约利用该信息作为 Proof mint 出等额 $BTC2L。

## 出金

用户在 L2 上将 $BTC2L 销毁，并在适当位置放置 L1 收款地址。BO 操作 L1 多签账户给对用户支付 BTC。

## 作恶与惩罚

- BO 不打包用户的 $BTC2L 销毁交易
  - 用户可以在 CKB 上直接证明自己拥有哪些 $BTC2L UTXO 并要求销毁退出，L2 需要在一定时间内响应，否则会罚没押金
- BO 不响应用户的出金请求
  - 用户等待 7 天后仍然没有收到出金交易，则可以在 CKB 上要求罚没 BO 押金
  - 通过提供 btc spv 证明与挑战，可以证明链上是否存在出金交易
- BO 恶意出金
  - 即出金没有对应到合法的 L2 $BTC2L UTXO，挑战者可以在 CKB 上罚没 BO 押金

## 额外安全

- 每条 L2 都有自己的 BO，此外还有系统 SBO
- BO + SBO 签名可以立刻转账
- BO 单独签名需要延期 7 天转账

## 安全性分析

BTC 跨链桥的安全性和系统押金一致————是否合理？